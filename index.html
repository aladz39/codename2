<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÙƒÙˆØ¯ Ù†ÙŠÙ…Ø² - Codenames</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* === Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ === */
        :root {
            --bg-dark: #0d1117;
            --bg-card: #161b22;
            --bg-hover: #21262d;
            --text-main: #f0f6fc;
            --text-muted: #8b949e;
            --red-team: #f85149;
            --red-bg: rgba(248, 81, 73, 0.15);
            --blue-team: #58a6ff;
            --blue-bg: rgba(88, 166, 255, 0.15);
            --gold: #d29922;
            --gold-bg: rgba(210, 153, 34, 0.15);
            --neutral: #8b949e;
            --neutral-revealed: #e5e5e5;
            --killer: #000000;
        }

        * {
            font-family: 'Tajawal', sans-serif;
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        body {
            background: var(--bg-dark);
            color: var(--text-main);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .hidden { display: none !important; }

        /* === Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø­Ø³Ù†Ø© === */
        .btn {
            cursor: pointer;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            width: 100%;
            touch-action: manipulation;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1),
                        box-shadow 0.2s ease,
                        background 0.2s ease;
        }

        .btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(255,255,255,0.1) 0%, transparent 50%);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .btn:hover::before {
            opacity: 1;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:active {
            transform: scale(0.96) translateY(0);
            transition: transform 0.1s ease;
        }

        .btn:disabled {
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--gold), #e6b800);
            color: #000;
            box-shadow: 0 4px 15px rgba(210, 153, 34, 0.4),
                        inset 0 1px 0 rgba(255,255,255,0.2);
        }

        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(210, 153, 34, 0.5),
                        inset 0 1px 0 rgba(255,255,255,0.2);
        }

        .btn-primary:active {
            box-shadow: 0 2px 10px rgba(210, 153, 34, 0.3);
        }

        .btn-gray {
            background: var(--bg-card);
            color: var(--text-main);
            border: 1px solid #30363d;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .btn-gray:hover {
            background: var(--bg-hover);
            border-color: #484f58;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .btn-gray:active {
            background: var(--bg-card);
        }

        .btn-red {
            background: linear-gradient(135deg, var(--red-team), #da3633);
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(248, 81, 73, 0.4);
        }

        .btn-red:hover {
            box-shadow: 0 6px 20px rgba(248, 81, 73, 0.5);
        }

        .btn-blue {
            background: linear-gradient(135deg, var(--blue-team), #388bfd);
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(88, 166, 255, 0.4);
        }

        .btn-blue:hover {
            box-shadow: 0 6px 20px rgba(88, 166, 255, 0.5);
        }

        /* === Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª === */
        .screen {
            position: fixed;
            inset: 0;
            background: var(--bg-dark);
            z-index: 10;
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        .screen.active {
            opacity: 1;
            visibility: visible;
        }

        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: 600px;
            width: 100%;
            margin: 0 auto;
            padding: 10px;
            overflow: hidden;
        }

        /* === Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠ === */
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 14px;
            background: var(--bg-card);
            border-radius: 12px;
            margin-bottom: 8px;
            border: 1px solid #30363d;
            flex-shrink: 0;
        }

        .score-box {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 900;
            font-size: 1.2rem;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            box-shadow: 0 0 8px currentColor;
        }

        /* === Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªÙ„Ù…ÙŠØ­ === */
        .hint-area {
            background: var(--gold-bg);
            border: 2px solid var(--gold);
            padding: 10px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 8px;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .hint-area.empty {
            background: var(--bg-card);
            border: 2px dashed #30363d;
            color: var(--text-muted);
        }

        .hint-text {
            font-size: 1.4rem;
            font-weight: 900;
            color: var(--gold);
            text-shadow: 0 0 20px rgba(210, 153, 34, 0.3);
        }

        /* === Ù„ÙˆØ­Ø© Ø§Ù„Ù„Ø¹Ø¨ === */
        .board-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-bottom: 8px;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 6px;
            width: 100%;
        }

        .card {
            aspect-ratio: 3 / 2.2;
            perspective: 1000px;
            cursor: pointer;
            position: relative;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
            transform-style: preserve-3d;
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            inset: 0;
            backface-visibility: hidden;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: clamp(0.75rem, 2.8vw, 1rem);
            text-align: center;
            padding: 4px;
            border: 2px solid #30363d;
            overflow: hidden;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .card-front {
            background: var(--bg-card);
            color: var(--text-main);
            z-index: 2;
        }

        .card:not(.flipped):hover .card-front {
            border-color: #484f58;
            box-shadow: 0 0 15px rgba(88, 166, 255, 0.2);
        }

        .card-back {
            transform: rotateY(180deg);
            border: 2px solid transparent;
            font-size: clamp(0.7rem, 2.5vw, 0.9rem);
        }

        .card-back.red { 
            background: var(--red-team); 
            color: white; 
            border-color: #ff7b72; 
            box-shadow: 0 0 20px rgba(248, 81, 73, 0.5);
        }
        .card-back.blue { 
            background: var(--blue-team); 
            color: #000; 
            border-color: #79c0ff;
            box-shadow: 0 0 20px rgba(88, 166, 255, 0.5);
        }
        .card-back.neutral { 
            background: var(--neutral-revealed); 
            color: #333; 
            border-color: #ccc; 
        }
        .card-back.killer { 
            background: var(--killer); 
            color: var(--gold); 
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(210, 153, 34, 0.5);
        }

        /* Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù‚Ø§Ø¦Ø¯ */
        .card.spymaster .card-front { border-width: 3px; }
        .card.spymaster-red .card-front { border-color: var(--red-team); box-shadow: 0 0 10px rgba(248, 81, 73, 0.3); }
        .card.spymaster-blue .card-front { border-color: var(--blue-team); box-shadow: 0 0 10px rgba(88, 166, 255, 0.3); }
        .card.spymaster-killer .card-front { border-color: var(--gold); box-shadow: 0 0 10px rgba(210, 153, 34, 0.3); }
        .card.spymaster-neutral .card-front { border-color: var(--neutral); }

        /* === Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø³ÙÙ„ÙŠØ© === */
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            flex-shrink: 0;
            padding-bottom: 8px;
        }
        .controls .full-width { grid-column: span 2; }

        /* === Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© === */
        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(13, 17, 23, 0.98);
            z-index: 50;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        .overlay.active { opacity: 1; visibility: visible; }

        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal.active { opacity: 1; visibility: visible; }

        .modal-box {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 24px;
            width: 100%;
            max-width: 360px;
            border: 1px solid #30363d;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            transform: scale(0.9);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .modal.active .modal-box {
            transform: scale(1);
        }

        .input-field {
            width: 100%;
            padding: 14px;
            border-radius: 10px;
            border: 2px solid #30363d;
            background: var(--bg-dark);
            color: var(--text-main);
            font-size: 1.1rem;
            margin-bottom: 14px;
            outline: none;
            text-align: center;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .input-field:focus { 
            border-color: var(--gold); 
            box-shadow: 0 0 15px rgba(210, 153, 34, 0.2);
        }

        /* Ø±Ø³ÙˆÙ… Ù…ØªØ­Ø±ÙƒØ© */
        @keyframes pulse { 
            0%, 100% { transform: scale(1); } 
            50% { transform: scale(1.05); } 
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .pulse-anim { animation: pulse 2s infinite; }
        .fade-in-up { animation: fadeInUp 0.5s ease forwards; }
    </style>
</head>
<body>

    <!-- ===== Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ===== -->
    <div id="screen-start" class="screen active">
        <div class="container" style="justify-content: center; align-items: center;">
            <h1 style="font-size: 3rem; font-weight: 900; background: linear-gradient(135deg, var(--red-team), var(--gold), var(--blue-team)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px;">ÙƒÙˆØ¯ Ù†ÙŠÙ…Ø²</h1>
            <p style="color: var(--text-muted); margin-bottom: 30px;">Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©</p>
            
            <div style="background: var(--bg-card); padding: 20px; border-radius: 16px; width: 100%; margin-bottom: 30px; border: 1px solid #30363d;">
                <h3 style="color: var(--gold); margin-bottom: 12px; font-size: 1.1rem;">Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨</h3>
                <ul style="text-align: right; color: var(--text-muted); font-size: 0.95rem; line-height: 2;">
                    <li><span style="color: var(--red-team);">â—</span> Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±: 9 ÙƒÙ„Ù…Ø§Øª (ÙŠØ¨Ø¯Ø£)</li>
                    <li><span style="color: var(--blue-team);">â—</span> Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚: 8 ÙƒÙ„Ù…Ø§Øª</li>
                    <li><span style="color: var(--gold);">â—</span> Ø§Ù„Ù‚Ø§Ø¦Ø¯ ÙŠØ±Ù‰ Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆÙŠØ¹Ø·ÙŠ ØªÙ„Ù…ÙŠØ­</li>
                    <li><span style="color: #fff; background: #333; padding: 0 6px; border-radius: 4px;">â—</span> Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø­Ø§ÙŠØ¯Ø© ØªØ¸Ù‡Ø± Ø¨ÙŠØ¶Ø§Ø¡</li>
                </ul>
            </div>
            <button id="btn-new-game" class="btn btn-primary" style="max-width: 280px;">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        </div>
    </div>

    <!-- ===== Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨ ===== -->
    <div id="screen-game" class="screen">
        <div class="container">
            <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
            <div class="status-bar">
                <div id="role-badge" style="padding: 6px 14px; border-radius: 20px; font-size: 0.85rem; font-weight: 700;"></div>
                <div style="display: flex; gap: 20px;">
                    <div class="score-box">
                        <div class="dot" style="background: var(--red-team); color: var(--red-team);"></div>
                        <span id="score-red">9</span>
                    </div>
                    <div class="score-box">
                        <div class="dot" style="background: var(--blue-team); color: var(--blue-team);"></div>
                        <span id="score-blue">8</span>
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„ØªÙ„Ù…ÙŠØ­ -->
            <div id="hint-area" class="hint-area empty">
                <span>Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙ„Ù…ÙŠØ­...</span>
            </div>

            <!-- Ø§Ù„Ù„ÙˆØ­Ø© -->
            <div class="board-wrapper">
                <div id="board" class="board"></div>
            </div>

            <!-- Ø§Ù„ØªØ­ÙƒÙ… -->
            <div class="controls">
                <button id="btn-give-hint" class="btn btn-gray">ØªÙ„Ù…ÙŠØ­</button>
                <button id="btn-end-turn" class="btn btn-gray">Ø¥Ù†Ù‡Ø§Ø¡</button>
                <button id="btn-menu" class="btn btn-gray full-width">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
            </div>
        </div>
    </div>

    <!-- ===== Ù†Ø§ÙØ°Ø© ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø¬Ù‡Ø§Ø² ===== -->
    <div id="overlay-pass" class="overlay">
        <div id="pass-icon" style="width: 90px; height: 90px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 3rem; margin-bottom: 24px;"></div>
        <h2 id="pass-title" style="font-size: 1.6rem; margin-bottom: 12px;"></h2>
        <p id="pass-subtitle" style="color: var(--text-muted); margin-bottom: 32px;"></p>
        <button id="btn-ready" class="btn btn-primary" style="max-width: 220px;">Ø¬Ø§Ù‡Ø²</button>
    </div>

    <!-- ===== Ù†ÙˆØ§ÙØ° Ù…Ù†Ø¨Ø«Ù‚Ø© ===== -->
    <div id="modal-hint" class="modal">
        <div class="modal-box">
            <h3 style="text-align: center; margin-bottom: 18px; color: var(--gold); font-size: 1.2rem;">Ø§Ø¹Ø·Ø§Ø¡ ØªÙ„Ù…ÙŠØ­</h3>
            <input type="text" id="input-hint-word" class="input-field" placeholder="Ø§Ù„ÙƒÙ„Ù…Ø©">
            <input type="number" id="input-hint-num" class="input-field" placeholder="Ø§Ù„Ø¹Ø¯Ø¯" min="1" max="9">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <button id="btn-submit-hint" class="btn btn-primary">ØªØ£ÙƒÙŠØ¯</button>
                <button id="btn-cancel-hint" class="btn btn-gray">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <div id="modal-gameover" class="modal">
        <div class="modal-box" style="text-align: center;">
            <div id="winner-icon" style="font-size: 4rem; margin-bottom: 12px;"></div>
            <h2 id="winner-text" style="font-size: 1.6rem; margin-bottom: 12px;"></h2>
            <p id="winner-reason" style="color: var(--text-muted); margin-bottom: 24px; font-size: 0.95rem;"></p>
            <button id="btn-play-again" class="btn btn-primary">Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
        </div>
    </div>

    <div id="modal-menu" class="modal">
        <div class="modal-box">
            <button id="btn-restart" class="btn btn-gray" style="margin-bottom: 10px;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
            <button id="btn-main-menu" class="btn btn-gray" style="margin-bottom: 10px;">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            <button id="btn-close-menu" class="btn btn-gray" style="background: #21262d;">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <script>
        const WORDS = [
            'Ø¨Ø­Ø±', 'Ù‚Ù…Ø±', 'Ø´Ù…Ø³', 'Ù†Ø¬Ù…', 'Ù…Ø·Ø±', 'Ø¬Ø¨Ù„', 'Ù†Ù‡Ø±', 'ØµØ­Ø±Ø§Ø¡', 'ØºØ§Ø¨Ø©', 'Ù…Ø¯ÙŠÙ†Ø©',
            'Ø¨ÙŠØª', 'Ø¨Ø§Ø¨', 'Ù†Ø§ÙØ°Ø©', 'Ø³Ù‚Ù', 'Ø­Ø§Ø¦Ø·', 'ÙƒØªØ§Ø¨', 'Ù‚Ù„Ù…', 'ÙˆØ±Ù‚Ø©', 'Ù…Ø¯Ø±Ø³Ø©', 'Ù…Ø¹Ù„Ù…',
            'Ø·Ø¨ÙŠØ¨', 'Ù…Ø³ØªØ´ÙÙ‰', 'Ø¯ÙˆØ§Ø¡', 'Ù…Ø±Ø¶', 'ØµØ­Ø©', 'Ø³ÙŠØ§Ø±Ø©', 'Ø·Ø§Ø¦Ø±Ø©', 'Ø³ÙÙŠÙ†Ø©', 'Ù‚Ø·Ø§Ø±', 'Ø·Ø±ÙŠÙ‚',
            'Ø®Ø¨Ø²', 'Ù…Ø§Ø¡', 'Ø­Ù„ÙŠØ¨', 'ÙØ§ÙƒÙ‡Ø©', 'Ø®Ø¶Ø§Ø±', 'Ø£Ø³Ø¯', 'Ù†Ù…Ø±', 'Ø°Ø¦Ø¨', 'Ø­ØµØ§Ù†', 'Ø·Ø§Ø¦Ø±',
            'Ø°Ù‡Ø¨', 'ÙØ¶Ø©', 'Ø­Ø¯ÙŠØ¯', 'Ù†Ø­Ø§Ø³', 'Ù…Ø¹Ø¯Ù†', 'Ù…Ù„Ùƒ', 'ÙˆØ²ÙŠØ±', 'Ø¬Ù†Ø¯ÙŠ', 'Ù‚Ø§Ø¦Ø¯', 'Ø´Ø±Ø·ÙŠ',
            'Ø­Ø±Ø¨', 'Ø³Ù„Ù…', 'Ø¹Ø¯Ùˆ', 'ØµØ¯ÙŠÙ‚', 'ØªØ­Ø§Ù„Ù', 'Ù„ÙŠÙ„', 'Ù†Ù‡Ø§Ø±', 'ØµØ¨Ø§Ø­', 'Ù…Ø³Ø§Ø¡', 'ÙˆÙ‚Øª',
            'Ø­Ø¨', 'ÙƒØ±Ù‡', 'ÙØ±Ø­', 'Ø­Ø²Ù†', 'Ø£Ù…Ù„', 'Ù†Ø§Ø±', 'Ø«Ù„Ø¬', 'Ø±ÙŠØ­', 'Ø³Ø­Ø§Ø¨', 'Ø¨Ø±Ù‚',
            'ÙˆÙ„Ø¯', 'Ø¨Ù†Øª', 'Ø±Ø¬Ù„', 'Ø§Ù…Ø±Ø£Ø©', 'Ø·ÙÙ„', 'Ø¹ÙŠÙ†', 'Ø£Ù†Ù', 'ÙÙ…', 'ÙŠØ¯', 'Ù‚Ø¯Ù…',
            'Ù‚Ù„Ø¨', 'Ø¯Ù…', 'Ø¹Ø¸Ù…', 'Ø¬Ù„Ø¯', 'Ø´Ø¹Ø±', 'ÙÙƒØ±', 'Ø¹Ù‚Ù„', 'Ø±ÙˆØ­', 'Ø¬Ø³Ù…', 'Ù†ÙØ³',
            'ÙƒØ±Ø©', 'Ù‡Ø¯Ù', 'ÙÙˆØ²', 'Ø®Ø³Ø§Ø±Ø©', 'ÙØ±ÙŠÙ‚', 'Ø³ÙŠÙ†Ù…Ø§', 'Ù…Ø³Ø±Ø­', 'Ù…ÙˆØ³ÙŠÙ‚Ù‰', 'Ø±Ø³Ù…', 'ÙÙ†',
            'Ø¬Ù…Ù„', 'ØµÙ‚Ø±', 'Ø¹Ù‚Ø§Ø¨', 'Ø«Ø¹Ù„Ø¨', 'Ø¯Ø¨', 'Ù‚Ø±Ø¯', 'ÙÙŠÙ„', 'Ø²Ø±Ø§ÙØ©', 'ØºØ²Ø§Ù„', 'Ø£Ø±Ù†Ø¨',
            'Ø³Ù„Ø­ÙØ§Ø©', 'Ø«Ø¹Ø¨Ø§Ù†', 'ØªÙ…Ø³Ø§Ø­', 'Ø­ÙˆØª', 'Ø³Ù…ÙƒØ©', 'Ù‚Ø±Ø´', 'Ø¯ÙˆÙ„ÙÙŠÙ†', 'Ø¨ÙˆÙ…Ø©', 'Ù†Ø­Ù„Ø©', 'Ù†Ù…Ù„Ø©',
            'Ø¹Ù†ÙƒØ¨ÙˆØª', 'ÙØ±Ø§Ø´Ø©', 'Ø®ÙØ§Ø´', 'Ø¬Ø±Ø§Ø¯', 'Ø¹Ù‚Ø±Ø¨', 'Ø¯Ø¬Ø§Ø¬Ø©', 'Ø­Ù…Ø§Ù…Ø©', 'Ø¨Ø·Ø±ÙŠÙ‚', 'Ù†Ø¹Ø§Ù…Ø©', 'Ø·Ø§ÙˆÙˆØ³',
            'Ø¨Ø¨ØºØ§Ø¡', 'Ø³Ù†ÙˆÙ†Ùˆ', 'Ø¸Ø¨ÙŠ', 'Ø­Ù…Ø§Ø±', 'Ø¨Ù‚Ø±Ø©', 'ÙØ£Ø±', 'Ø´Ø¬Ø±Ø©', 'Ø²Ù‡Ø±Ø©', 'ÙˆØ±Ø¯Ø©', 'Ù†Ø®ÙŠÙ„',
            'ØµØ¨Ø§Ø±', 'Ø¨Ù„ÙˆØ·', 'Ø²ÙŠØªÙˆÙ†', 'Ø¹Ù†Ø¨', 'ØªÙØ§Ø­', 'Ù…ÙˆØ²', 'Ø¨Ø±ØªÙ‚Ø§Ù„', 'Ù„ÙŠÙ…ÙˆÙ†', 'Ù…Ø§Ù†Ø¬Ùˆ', 'Ø¨Ø·ÙŠØ®',
            'ÙØ±Ø§ÙˆÙ„Ø©', 'ØªÙŠÙ†', 'Ø±Ù…Ø§Ù†', 'Ø¬Ø²Ø±', 'Ø¨Ø·Ø§Ø·Ø³', 'Ø·Ù…Ø§Ø·Ù…', 'Ø®ÙŠØ§Ø±', 'Ø¨ØµÙ„', 'Ø«ÙˆÙ…', 'Ù‚Ù…Ø­',
            'Ø´Ø¹ÙŠØ±', 'Ø£Ø±Ø²', 'Ø°Ø±Ø©', 'Ø¹Ø´Ø¨', 'Ø³Ø±Ø®Ø³', 'Ø·Ø­Ù„Ø¨', 'Ø­Ø´ÙŠØ´', 'Ù†Ø¨Ø¹', 'Ù…Ø­ÙŠØ·', 'Ø¨Ø­ÙŠØ±Ø©',
            'Ø³Ø¯', 'Ø´Ù„Ø§Ù„', 'ØªÙ„Ø©', 'ÙˆØ§Ø¯', 'Ø±Ù…Ù„', 'ØµØ®Ø±', 'Ø­Ø¬Ø±', 'ÙƒÙ‡Ù', 'ØºØ§Ø±', 'Ø¨Ø±ÙƒØ§Ù†',
            'Ø²Ù„Ø²Ø§Ù„', 'Ø¹Ø§ØµÙØ©', 'Ø¬Ù„ÙŠØ¯', 'Ø¶Ø¨Ø§Ø¨', 'ÙƒÙˆÙƒØ¨', 'Ø¬Ø²ÙŠØ±Ø©', 'Ø´Ø§Ø·Ø¦', 'ÙƒØ«ÙŠØ¨', 'ÙˆØ§Ø­Ø©', 'Ø¨Ø¦Ø±',
            'Ù…ØºØ§Ø±Ø©', 'Ù‡Ø¶Ø¨Ø©', 'Ø³Ù‡Ù„', 'ØªÙŠØ§Ø±', 'Ù…ÙˆØ¬Ø©', 'Ù‚ØµØ±', 'ÙƒÙˆØ®', 'Ø®ÙŠÙ…Ø©', 'Ø¨Ø±Ø¬', 'Ø¬Ø¯Ø§Ø±',
            'Ø³ÙˆØ±', 'Ø¬Ø³Ø±', 'Ù…ÙŠÙ†Ø§Ø¡', 'Ù…Ø·Ø§Ø±', 'Ù…Ø­Ø·Ø©', 'Ø³ÙˆÙ‚', 'Ù…Ø³Ø¬Ø¯', 'ÙƒÙ†ÙŠØ³Ø©', 'Ø³Ø¬Ù†', 'Ù‚Ù„Ø¹Ø©',
            'Ø­ØµÙ†', 'Ù…Ø±ÙƒØ¨', 'ØºÙˆØ§ØµØ©', 'Ù…Ø±ÙˆØ­ÙŠØ©', 'ØµØ§Ø±ÙˆØ®', 'Ø´Ø§Ø­Ù†Ø©', 'Ø¯Ø±Ø§Ø¬Ø©', 'Ø³Ø§Ø¹Ø©', 'Ù…Ø±Ø¢Ø©', 'Ø³ÙŠÙ',
            'Ø¯Ø±Ø¹', 'ØªØ§Ø¬', 'Ø¹Ø±Ø´', 'Ù‚ÙˆØ³', 'Ø³Ù‡Ù…', 'Ø±Ù…Ø­', 'Ø·ÙˆØ¨', 'Ø£Ø³Ù…Ù†Øª', 'Ø²Ø¬Ø§Ø¬', 'Ø®Ø´Ø¨',
            'Ø¨Ù„Ø§Ø·', 'Ø³Ù„Ù…', 'Ù…ØµØ¹Ø¯', 'Ø­Ø¯ÙŠÙ‚Ø©', 'Ù…Ø²Ø±Ø¹Ø©', 'Ø¨Ø³ØªØ§Ù†', 'Ø³ÙƒÙŠÙ†', 'Ù…Ù„Ø¹Ù‚Ø©', 'Ø´ÙˆÙƒØ©', 'Ø·Ø¨Ù‚',
            'ÙƒÙˆØ¨', 'Ø¥Ø¨Ø±ÙŠÙ‚', 'Ø¨Ø±Ø§Ø¯', 'Ù‚Ø¯Ø±', 'Ù…Ù‚Ù„Ø§Ø©', 'Ø«Ù„Ø§Ø¬Ø©', 'Ø®Ù„Ø§Ø·', 'Ù…Ø¨Ø´Ø±Ø©', 'ØµÙŠÙ†ÙŠØ©', 'Ù‚Ø§Ø±ÙˆØ±Ø©',
            'Ø¹Ù„Ø¨Ø©', 'Ù…ÙƒÙ†Ø³Ø©', 'Ø¯Ù„Ùˆ', 'Ø¥Ø³ÙÙ†Ø¬', 'ØµØ§Ø¨ÙˆÙ†', 'Ø«ÙˆØ¨', 'Ø¹Ø¨Ø§Ø¡Ø©', 'Ù‚Ù…ÙŠØµ', 'Ø¬ÙŠÙ†Ø²', 'ÙØ³ØªØ§Ù†',
            'ØªÙ†ÙˆØ±Ø©', 'Ù…Ø¹Ø·Ù', 'Ø¬Ø§ÙƒÙŠØª', 'Ù‚Ø¨Ø¹Ø©', 'ÙƒÙˆÙÙŠØ©', 'Ø­Ø²Ø§Ù…', 'Ø­Ø°Ø§Ø¡', 'Ù†Ø¹Ù„', 'Ù†Ø¸Ø§Ø±Ø©', 'Ø­Ù‚ÙŠØ¨Ø©',
            'Ù…Ø­ÙØ¸Ø©', 'Ø´Ø§Ù„', 'Ø·Ø±Ø­Ø©', 'Ø¬ÙˆØ±Ø¨', 'Ù‚ÙØ§Ø²', 'ØµÙˆÙ', 'Ù‚Ø·Ù†', 'Ø­Ø±ÙŠØ±', 'ÙƒØªØ§Ù†', 'Ø¬Ù„Ø¯',
            'ÙØ±Ø§Ø¡', 'Ø¨Ù„Ø§Ø³ØªÙŠÙƒ', 'Ù…Ø·Ø§Ø·', 'ÙˆØ±Ù‚', 'ÙƒØ±ØªÙˆÙ†', 'Ø±Ø®Ø§Ù…', 'Ø¬Ø±Ø§Ù†ÙŠØª', 'Ø·ÙŠÙ†', 'Ø¯Ù‡Ø§Ù†', 'Ø­Ø¨Ø±',
            'Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ', 'Ù†Ø¬Ø§Ø±', 'Ø­Ø¯Ø§Ø¯', 'Ø®ÙŠØ§Ø·', 'Ø¨Ù†Ø§Ø¡', 'Ø³Ù…ÙƒØ±ÙŠ', 'ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ', 'Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ', 'Ø¨Ø­Ø§Ø±', 'Ø³Ø§Ø¦Ù‚',
            'Ø­Ø§Ø±Ø³', 'Ø·Ø¨Ø§Ø®', 'Ù†Ø§Ø¯Ù„', 'Ø®Ø¨Ø§Ø²', 'ÙÙ„Ø§Ø­', 'ØµÙŠØ§Ø¯', 'ØªØ§Ø¬Ø±', 'ØµØ§Ù†Ø¹', 'Ù…ÙˆØ¸Ù', 'Ù…Ø¯ÙŠØ±',
            'ØµÙŠØ¯Ù„ÙŠ', 'Ù‡Ø§ØªÙ', 'Ø¬ÙˆØ§Ù„', 'Ø­Ø§Ø³ÙˆØ¨', 'Ù„Ø§Ø¨ØªÙˆØ¨', 'ØªØ§Ø¨Ù„Øª', 'ØªÙ„ÙØ§Ø²', 'Ø±Ø§Ø¯ÙŠÙˆ', 'ÙƒØ§Ù…ÙŠØ±Ø§', 'Ø¨Ø·Ø§Ø±ÙŠØ©',
            'Ø´Ø§Ø­Ù†', 'Ø´Ø§Ø´Ø©', 'Ø·Ø§Ø¨Ø¹Ø©', 'Ù…ÙˆØ¯Ù…', 'Ø³Ù…Ø§Ø¹Ø©', 'Ù…Ø§ÙˆØ³', 'ÙƒÙŠØ¨ÙˆØ±Ø¯', 'Ø³Ù„Ùƒ', 'Ù…Ù‚Ø¨Ø³', 'Ø±ÙŠÙ…ÙˆØª',
            'Ø³Ø±ÙŠØ±', 'ÙˆØ³Ø§Ø¯Ø©', 'Ù„Ø­Ø§Ù', 'Ø¨Ø·Ø§Ù†ÙŠØ©', 'ÙƒÙ†Ø¨Ø©', 'Ø£Ø±ÙŠÙƒØ©', 'Ù…ÙƒØªØ¨', 'Ø®Ø²Ø§Ù†Ø©', 'Ø¯ÙˆÙ„Ø§Ø¨', 'Ø³Ø¬Ø§Ø¯Ø©',
            'Ø³ØªØ§Ø±Ø©', 'Ù…ØµØ¨Ø§Ø­', 'ÙØ§Ù†ÙˆØ³', 'Ø¨Ù„ÙƒÙˆÙ†Ø©', 'Ø³Ø±Ø¯Ø§Ø¨', 'Ù…Ù‚Ø¹Ø¯', 'Ù…Ø±ØªØ¨Ø©', 'Ø¹ØªØ¨Ø©', 'Ø³ØªØ§Ù†Ø¯', 'Ø¬Ø¨Ù†',
            'Ø²Ø¨Ø¯Ø©', 'Ø²ÙŠØª', 'Ø®Ù„', 'Ø¹Ø³Ù„', 'Ù…Ø±Ø¨Ù‰', 'Ø²Ø¨ÙŠØ¨', 'Ù„ÙˆØ²', 'ÙØ³ØªÙ‚', 'ÙƒØ§Ø¬Ùˆ', 'Ø¬ÙˆØ²',
            'ÙÙˆÙ„', 'Ø¹Ø¯Ø³', 'Ø­Ù…Øµ', 'ÙØ§ØµÙˆÙ„ÙŠØ§', 'Ù„ÙˆØ¨ÙŠØ§', 'Ø¨Ø§Ø²Ù„Ø§Ø¡', 'Ù…ÙƒØ±ÙˆÙ†Ø©', 'Ø´Ø¹Ø±ÙŠØ©', 'ÙƒÙ†Ø§ÙØ©', 'Ù‚Ø§Ø±Ø©',
            'Ù…Ø¶ÙŠÙ‚', 'Ø®Ù„ÙŠØ¬', 'ØªÙ„Ø§Ù„', 'ØµØ®ÙˆØ±', 'ÙŠÙ†Ø¨ÙˆØ¹', 'ØºØ¯ÙŠØ±', 'Ø¨Ø±ÙƒØ©', 'Ù…Ø³ØªÙ†Ù‚Ø¹', 'Ø¯Ø®Ø§Ù†', 'Ø¬ÙˆÙ‡Ø±'
        ];

        let state = {
            cards: [],
            currentTeam: 'red',
            role: 'spymaster',
            scores: { red: 0, blue: 0 },
            hint: null,
            guessesLeft: 0,
            hintGiven: false,
            gameOver: false
        };

        const $ = id => document.getElementById(id);
        const screens = { start: $('screen-start'), game: $('screen-game') };
        const modals = { hint: $('modal-hint'), gameover: $('modal-gameover'), menu: $('modal-menu'), pass: $('overlay-pass') };

        function shuffle(arr) {
            const a = [...arr];
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        function showScreen(name) {
            Object.values(screens).forEach(s => s.classList.remove('active'));
            screens[name].classList.add('active');
        }

        function toggleModal(name, show) {
            if (show) modals[name].classList.add('active');
            else modals[name].classList.remove('active');
        }

        function initGame() {
            state = {
                cards: [],
                currentTeam: 'red',
                role: 'spymaster',
                scores: { red: 0, blue: 0 },
                hint: null,
                guessesLeft: 0,
                hintGiven: false,
                gameOver: false
            };

            const words = shuffle(WORDS).slice(0, 25);
            const types = shuffle([
                ...Array(9).fill('red'),
                ...Array(8).fill('blue'),
                ...Array(7).fill('neutral'),
                'killer'
            ]);

            state.cards = words.map((word, i) => ({
                word,
                type: types[i],
                revealed: false
            }));

            renderBoard();
            updateUI();
            showScreen('game');
            toggleModal('pass', true);
            showPassScreen();
        }

        function renderBoard() {
            const board = $('board');
            board.innerHTML = '';

            state.cards.forEach((card, idx) => {
                const div = document.createElement('div');
                div.className = 'card';
                
                if (state.role === 'spymaster' && !card.revealed) {
                    div.classList.add('spymaster', `spymaster-${card.type}`);
                }

                if (card.revealed) div.classList.add('flipped');

                div.innerHTML = `
                    <div class="card-inner">
                        <div class="card-face card-front">${card.word}</div>
                        <div class="card-face card-back ${card.type}">${card.word}</div>
                    </div>
                `;

                if (state.role === 'operative' && !card.revealed && state.hintGiven && !state.gameOver) {
                    div.onclick = () => revealCard(idx);
                    div.style.cursor = 'pointer';
                } else {
                    div.style.cursor = 'default';
                }

                board.appendChild(div);
            });
        }

        function updateUI() {
            $('score-red').textContent = 9 - state.scores.red;
            $('score-blue').textContent = 8 - state.scores.blue;

            const teamName = state.currentTeam === 'red' ? 'Ø§Ù„Ø£Ø­Ù…Ø±' : 'Ø§Ù„Ø£Ø²Ø±Ù‚';
            const roleName = state.role === 'spymaster' ? 'Ù‚Ø§Ø¦Ø¯' : 'Ù„Ø§Ø¹Ø¨';
            const color = state.currentTeam === 'red' ? 'var(--red-team)' : 'var(--blue-team)';
            const bg = state.currentTeam === 'red' ? 'var(--red-bg)' : 'var(--blue-bg)';

            $('role-badge').style.background = bg;
            $('role-badge').style.color = color;
            $('role-badge').textContent = `${roleName}: ${teamName}`;

            const hintArea = $('hint-area');
            if (state.hint && state.role === 'operative') {
                hintArea.className = 'hint-area';
                hintArea.innerHTML = `
                    <div style="font-size: 0.8rem; color: var(--text-muted);">Ø§Ù„ØªÙ„Ù…ÙŠØ­</div>
                    <div class="hint-text">${state.hint.word} (${state.hint.count})</div>
                    <div style="font-size: 0.8rem; color: var(--text-muted);">Ù…ØªØ¨Ù‚ÙŠ: ${state.guessesLeft}</div>
                `;
            } else {
                hintArea.className = 'hint-area empty';
                hintArea.innerHTML = `<span>${state.role === 'spymaster' ? 'Ø£Ø¹Ø·Ù ØªÙ„Ù…ÙŠØ­Ø§Ù‹ Ù„ÙØ±ÙŠÙ‚Ùƒ' : 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙ„Ù…ÙŠØ­...'}</span>`;
            }

            const isSpymaster = state.role === 'spymaster';
            $('btn-give-hint').disabled = !(isSpymaster && !state.hintGiven);
            $('btn-give-hint').style.opacity = (isSpymaster && !state.hintGiven) ? '1' : '0.4';
            $('btn-end-turn').textContent = isSpymaster ? 'ØªØ³Ù„ÙŠÙ… Ù„Ù„Ø§Ø¹Ø¨' : 'Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø¯ÙˆØ±';
        }

        function showPassScreen() {
            const team = state.currentTeam;
            const isSpymaster = state.role === 'spymaster';
            const teamName = team === 'red' ? 'Ø§Ù„Ø£Ø­Ù…Ø±' : 'Ø§Ù„Ø£Ø²Ø±Ù‚';
            const roleName = isSpymaster ? 'Ø§Ù„Ù‚Ø§Ø¦Ø¯' : 'Ø§Ù„Ù„Ø§Ø¹Ø¨';
            const bg = team === 'red' ? 'var(--red-bg)' : 'var(--blue-bg)';

            $('pass-icon').style.background = bg;
            $('pass-icon').textContent = team === 'red' ? 'ğŸ”´' : 'ğŸ”µ';
            $('pass-title').textContent = `Ø³Ù„Ù… Ø§Ù„Ø¬Ù‡Ø§Ø² Ù„ÙØ±ÙŠÙ‚ ${teamName}`;
            $('pass-title').style.color = team === 'red' ? 'var(--red-team)' : 'var(--blue-team)';
            $('pass-subtitle').textContent = `Ø§Ù„Ø¯ÙˆØ±: ${roleName}`;

            toggleModal('pass', true);
        }

        function revealCard(idx) {
            if (state.gameOver || state.role !== 'operative' || !state.hintGiven || state.guessesLeft <= 0) return;

            const card = state.cards[idx];
            if (card.revealed) return;

            card.revealed = true;
            state.guessesLeft--;

            const cards = document.querySelectorAll('.card');
            cards[idx].classList.add('flipped');

            setTimeout(() => {
                if (card.type === 'killer') {
                    endGame(state.currentTeam === 'red' ? 'blue' : 'red', 'killer');
                } else if (card.type === state.currentTeam) {
                    state.scores[state.currentTeam]++;
                    updateUI();
                    if ((state.currentTeam === 'red' && state.scores.red >= 9) || 
                        (state.currentTeam === 'blue' && state.scores.blue >= 8)) {
                        endGame(state.currentTeam, 'words');
                    } else if (state.guessesLeft <= 0) {
                        endTurn();
                    }
                } else {
                    if (card.type === 'red') state.scores.red++;
                    else if (card.type === 'blue') state.scores.blue++;
                    updateUI();
                    endTurn();
                }
            }, 500);
        }

        function endTurn() {
            if (state.role === 'spymaster') {
                if (!state.hintGiven) { alert('Ø£Ø¹Ø·Ù ØªÙ„Ù…ÙŠØ­Ø§Ù‹ Ø£ÙˆÙ„Ø§Ù‹!'); return; }
                state.role = 'operative';
                renderBoard();
            } else {
                state.hintGiven = false;
                state.hint = null;
                state.guessesLeft = 0;
                state.role = 'spymaster';
                state.currentTeam = state.currentTeam === 'red' ? 'blue' : 'red';
            }
            updateUI();
            showPassScreen();
        }

        function endGame(winner, reason) {
            state.gameOver = true;
            const name = winner === 'red' ? 'Ø§Ù„Ø£Ø­Ù…Ø±' : 'Ø§Ù„Ø£Ø²Ø±Ù‚';
            
            $('winner-icon').textContent = winner === 'red' ? 'ğŸ”´' : 'ğŸ”µ';
            $('winner-text').textContent = `ÙÙˆØ² ÙØ±ÙŠÙ‚ ${name}!`;
            $('winner-text').style.color = winner === 'red' ? 'var(--red-team)' : 'var(--blue-team)';
            $('winner-reason').textContent = reason === 'killer' ? 'ØªÙ… ÙƒØ´Ù Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù‚Ø§ØªÙ„Ø©!' : 'ØªÙ… Ø¥ÙŠØ¬Ø§Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª!';
            
            toggleModal('gameover', true);
        }

        // Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        $('btn-new-game').onclick = initGame;
        
        $('btn-ready').onclick = () => {
            toggleModal('pass', false);
            renderBoard();
            updateUI();
        };

        $('btn-give-hint').onclick = () => {
            if (state.role === 'spymaster' && !state.hintGiven) toggleModal('hint', true);
        };

        $('btn-submit-hint').onclick = () => {
            const word = $('input-hint-word').value.trim();
            const num = parseInt($('input-hint-num').value);
            if (!word || !num || num < 1 || num > 9) { alert('ØªÙ„Ù…ÙŠØ­ ØºÙŠØ± ØµØ§Ù„Ø­'); return; }

            state.hint = { word, count: num };
            state.hintGiven = true;
            state.guessesLeft = num + 1;
            
            $('input-hint-word').value = '';
            $('input-hint-num').value = '';
            toggleModal('hint', false);
            updateUI();
        };

        $('btn-cancel-hint').onclick = () => toggleModal('hint', false);
        $('btn-end-turn').onclick = endTurn;

        $('btn-menu').onclick = () => toggleModal('menu', true);
        $('btn-close-menu').onclick = () => toggleModal('menu', false);
        $('btn-restart').onclick = () => { toggleModal('menu', false); initGame(); };
        $('btn-main-menu').onclick = () => { toggleModal('menu', false); showScreen('start'); };
        $('btn-play-again').onclick = () => { toggleModal('gameover', false); initGame(); };

    </script>
</body>
</html>